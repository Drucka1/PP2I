CREATE TABLE user (
    id INTEGER PRIMARY KEY,
    username TEXT UNIQUE NOT NULL,
    password TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,

    lastname TEXT,
    firstname TEXT,
    gender TEXT,
    budget REAL
);
CREATE TABLE recipes(id INTEGER PRIMARY KEY, title VARCHAR NOT NULL, servings INTEGER NOT NULL, servingsunit VARCHAR NOT NULL, imageURL VARCHAR NOT NULL);
CREATE TABLE categories(id INTEGER PRIMARY KEY, name VARCHAR UNIQUE NOT NULL);
CREATE TABLE category(recipeid INTEGER NOT NULL, categoryid INTEGER NOT NULL, PRIMARY KEY(recipeid, categoryid), FOREIGN KEY(recipeid) REFERENCES recipes(id), FOREIGN KEY(categoryid) REFERENCES categories(id));
CREATE TABLE ingredients(id INTEGER PRIMARY KEY, name VARCHAR UNIQUE NOT NULL, price REAL NOT NULL);
CREATE TABLE ingredient(recipeid INTEGER NOT NULL, line INTEGER NOT NULL, amountint INTEGER NOT NULL, amountnum INTEGER NOT NULL, amountdenom INTEGER NOT NULL, amountfloat REAL NOT NULL, unit CHARACTER(2) NOT NULL, ingredientid INTEGER NOT NULL, PRIMARY KEY(recipeid, line), FOREIGN KEY(recipeid) REFERENCES recipes(id), FOREIGN KEY(ingredientid) REFERENCES ingredients(id));
CREATE TABLE instruction(recipeid INTEGER NOT NULL, line INTEGER NOT NULL, txt TEXT NOT NULL, PRIMARY KEY(recipeid, line), FOREIGN KEY(recipeid) REFERENCES recipes(id));
CREATE TABLE ingredientsection(recipeid INTEGER NOT NULL, line INTEGER NOT NULL, title VARCHAR(60) NOT NULL, PRIMARY KEY (recipeid, line), FOREIGN KEY(recipeid) REFERENCES recipes(id));
CREATE TABLE instructionsection(recipeid INTEGER NOT NULL, line INTEGER NOT NULL, title VARCHAR NOT NULL, PRIMARY KEY (recipeid, line), FOREIGN KEY(recipeid) REFERENCES recipes(id));
CREATE TABLE recipe (
	id INTEGER NOT NULL, 
	title VARCHAR(120) NOT NULL, 
	servings INTEGER NOT NULL, 
	servings_unit VARCHAR(20) NOT NULL, 
	image_url VARCHAR(255) NOT NULL, 
	PRIMARY KEY (id)
);
CREATE TABLE recipe_category (
	recipe_id INTEGER NOT NULL, 
	category_id INTEGER NOT NULL, 
	PRIMARY KEY (recipe_id, category_id), 
	FOREIGN KEY(recipe_id) REFERENCES recipe (id), 
	FOREIGN KEY(category_id) REFERENCES category (id)
);
CREATE TABLE recipe_ingredient (
	recipe_id INTEGER NOT NULL, 
	line INTEGER NOT NULL, 
	amount_int INTEGER NOT NULL, 
	amount_num INTEGER NOT NULL, 
	amount_denom INTEGER NOT NULL, 
	amount_float FLOAT NOT NULL, 
	unit VARCHAR(2) NOT NULL, 
	ingredient_id INTEGER NOT NULL, 
	PRIMARY KEY (recipe_id, line), 
	FOREIGN KEY(recipe_id) REFERENCES recipe (id), 
	FOREIGN KEY(ingredient_id) REFERENCES ingredient (id)
);
CREATE TABLE ingredient_section (
	recipe_id INTEGER NOT NULL, 
	line INTEGER NOT NULL, 
	title VARCHAR(60) NOT NULL, 
	PRIMARY KEY (recipe_id, line), 
	FOREIGN KEY(recipe_id) REFERENCES recipe (id)
);
CREATE TABLE instruction_section (
	recipe_id INTEGER NOT NULL, 
	line INTEGER NOT NULL, 
	title VARCHAR(120) NOT NULL, 
	PRIMARY KEY (recipe_id, line), 
	FOREIGN KEY(recipe_id) REFERENCES recipe (id)
);
